@use '@angular/material' as mat;
@use '../m3-theme' as m3;

body.cyberpunk-theme {
  // 赛博朋克配色
  --cyber-primary: #00ff41;
  --cyber-accent: #ff00ff;
  --cyber-dark: #0d0221;
  --cyber-grid: #1a1a2e;

  background: linear-gradient(180deg, var(--cyber-dark) 0%, var(--cyber-grid) 50%, #16213e 100%);
  color: var(--cyber-primary);

  // 主体/侧边栏容器
  .mat-drawer-container,
  .mat-sidenav-container {
    background: linear-gradient(180deg, #0d0221 0%, #14142f 45%, #0d0221 100%);
    color: var(--cyber-primary);
    font-family: 'Courier New', monospace;
  }

  .mat-drawer-content,
  .mat-sidenav-content,
  .main-content {
    background:
      radial-gradient(circle at 25% 10%, rgba(255, 0, 255, 0.08), transparent 35%),
      radial-gradient(circle at 80% 20%, rgba(0, 255, 65, 0.08), transparent 30%),
      linear-gradient(180deg, rgba(13, 2, 33, 0.95) 0%, rgba(26, 26, 46, 0.92) 50%, rgba(22, 33, 62, 0.9) 100%);
    color: var(--cyber-primary);
    font-family: 'Courier New', monospace;
  }

  // 网格背景
  &::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-image:
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0,255,65,0.03) 2px,
        rgba(0,255,65,0.03) 4px
      );
    pointer-events: none;
    z-index: -1;
    animation: matrix-rain 10s linear infinite;
  }

  @keyframes matrix-rain {
    0% { transform: translateY(0); }
    100% { transform: translateY(40px); }
  }

  // 侧边栏
  .mat-sidenav {
    background: rgba(13, 2, 33, 0.95);
    border-right: 2px solid var(--cyber-primary);
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.4);

    .mat-mdc-button {
      color: var(--cyber-primary);
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      border-left: 3px solid transparent;
      position: relative;

      &:hover {
        background: rgba(0, 255, 65, 0.1);
        border-left-color: var(--cyber-accent);
        text-shadow: 0 0 5px var(--cyber-primary);
      }

      &--active {
        background: rgba(0, 255, 65, 0.2);
        border-left-color: var(--cyber-accent);
        color: var(--cyber-accent);
      }
    }

    .mat-divider {
      border-color: var(--cyber-primary);
      opacity: 0.5;
      height: 2px;
    }
  }

  // 顶部工具栏
  .mat-toolbar,
  .toolbar {
    background: linear-gradient(90deg, rgba(0,255,65,0.12) 0%, rgba(255,0,255,0.16) 100%);
    border-bottom: 2px solid var(--cyber-primary);
    box-shadow: 0 0 26px rgba(0, 255, 65, 0.45);
    color: var(--cyber-primary);
    font-family: 'Courier New', monospace;
    text-transform: uppercase;
  }

  // 卡片组件
  .mat-mdc-card {
    background: rgba(13, 2, 33, 0.9);
    border: 1px solid var(--cyber-accent);
    box-shadow: 0 0 20px rgba(255, 0, 255, 0.3);
    position: relative;
    color: var(--cyber-primary);

    &::before {
      content: '';
      position: absolute;
      top: -1px;
      left: -1px;
      right: -1px;
      bottom: -1px;
      background: linear-gradient(45deg, var(--cyber-primary), transparent);
      z-index: -1;
      opacity: 0.3;
      animation: cyber-border-glow 2s ease-in-out infinite alternate;
    }

    &:hover {
      border-color: var(--cyber-primary);
      box-shadow: 0 0 30px rgba(0, 255, 65, 0.5);
    }

    .mat-mdc-card-title {
      color: var(--cyber-accent);
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .mat-mdc-card-subtitle {
      color: rgba(0, 255, 65, 0.8);
      font-family: 'Courier New', monospace;
    }

    .mat-mdc-card-content {
      color: var(--cyber-primary);
      font-family: 'Courier New', monospace;
    }
  }

  // 仓库列表卡片
  .repository-list {
    &__item {
      background: transparent;
      border-radius: 14px;
      box-shadow: 0 0 22px rgba(0, 255, 65, 0.18);

      &--add {
        border: 1px dashed rgba(0, 255, 65, 0.35);
        background: rgba(13, 2, 33, 0.65);
        color: var(--cyber-primary);
        text-transform: uppercase;
        font-family: 'Courier New', monospace;
      }
    }

    &__item-content {
      background:
        radial-gradient(circle at 25% 15%, rgba(255, 0, 255, 0.1), transparent 45%),
        radial-gradient(circle at 75% 10%, rgba(0, 255, 65, 0.1), transparent 35%),
        rgba(10, 2, 26, 0.9);
      border: 1px solid rgba(255, 0, 255, 0.25);
      box-shadow: 0 0 20px rgba(255, 0, 255, 0.25);
      color: var(--cyber-primary);
      border-radius: 12px;
      font-family: 'Courier New', monospace;
    }
  }

  .repository-drag-handle mat-icon {
    color: var(--cyber-primary);
    text-shadow: 0 0 4px var(--cyber-primary);
  }

  .repository-head__title a {
    color: var(--cyber-primary);

    h2 {
      color: var(--cyber-accent);
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 0 0 6px var(--cyber-accent);
    }
  }

  .repository-head {
    background: rgba(0, 255, 65, 0.08);
    border: 1px solid rgba(0, 255, 65, 0.12);
    border-radius: 10px;
    padding: 6px 8px;
    backdrop-filter: blur(6px);
  }

  .branch-title {
    color: var(--cyber-primary);

    &__icon {
      fill: var(--cyber-primary);
      filter: drop-shadow(0 0 4px var(--cyber-primary));
    }
  }

  .workflow-list__item ana-status-tag .tag {
    border: 1px solid rgba(0, 255, 65, 0.4);
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.35);
  }

  @keyframes cyber-border-glow {
    0% { opacity: 0.1; }
    100% { opacity: 0.4; }
  }

  // 进度条
  .mat-mdc-progress-bar {
    .mdc-linear-progress__buffer {
      background-color: rgba(0, 255, 65, 0.1);
    }

    .mdc-linear-progress__bar-inner {
      border-color: var(--cyber-primary);
      box-shadow: 0 0 10px var(--cyber-primary);
    }
  }

  // 状态标签
  .u-state-tag {
    border-color: var(--cyber-accent);
    color: var(--cyber-accent);
    font-family: 'Courier New', monospace;
    text-transform: uppercase;
    letter-spacing: 1px;

    &--active {
      color: var(--cyber-primary);
      border-color: var(--cyber-primary);
      text-shadow: 0 0 5px var(--cyber-primary);
    }

    &--error, &--failure {
      color: #ff0040;
      border-color: #ff0040;
      text-shadow: 0 0 5px #ff0040;
      animation: cyber-error 0.5s ease-in-out infinite alternate;
    }

    &--in_progress, &--pending, &--queued, &--waiting {
      color: var(--cyber-primary);
      border-color: var(--cyber-primary);
      animation: cyber-pulse 1s ease-in-out infinite;
    }
  }

  @keyframes cyber-error {
    0% { opacity: 1; }
    100% { opacity: 0.6; }
  }

  @keyframes cyber-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  // 构建状态
  ana-status-with-text {
    .status-text {
      color: rgba(0, 255, 65, 0.9);
      text-transform: uppercase;
    }

    .status__icon--pending {
      fill: var(--cyber-primary);
      filter: drop-shadow(0 0 4px var(--cyber-primary));
    }

    .status__icon--success {
      fill: var(--cyber-accent);
      filter: drop-shadow(0 0 4px var(--cyber-accent));
    }

    .status__icon--failed {
      fill: #ff0040;
      filter: drop-shadow(0 0 4px #ff0040);
    }
  }

  // 表单元素
  .mat-mdc-form-field {
    .mat-mdc-text-field-wrapper {
      background-color: rgba(0, 255, 65, 0.05);
      border-color: var(--cyber-primary);

      &.mdc-text-field--focused {
        border-color: var(--cyber-accent);
        box-shadow: 0 0 10px rgba(255, 0, 255, 0.5);
      }
    }

    .mat-mdc-input-element {
      color: var(--cyber-primary);
      font-family: 'Courier New', monospace;

      &::placeholder {
        color: rgba(0, 255, 65, 0.5);
      }
    }

    .mat-mdc-floating-label {
      color: var(--cyber-accent);
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
    }
  }

  // 按钮
  .mat-mdc-raised-button {
    background: linear-gradient(45deg, rgba(0,255,65,0.2), rgba(255,0,255,0.2));
    color: var(--cyber-primary);
    border: 1px solid var(--cyber-primary);
    font-family: 'Courier New', monospace;
    text-transform: uppercase;
    letter-spacing: 1px;

    &:hover {
      background: linear-gradient(45deg, rgba(0,255,65,0.3), rgba(255,0,255,0.3));
      border-color: var(--cyber-accent);
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.6);
    }
  }

  .mat-mdc-outlined-button {
    border-color: var(--cyber-primary);
    color: var(--cyber-accent);
    font-family: 'Courier New', monospace;
    text-transform: uppercase;

    &:hover {
      background: rgba(0, 255, 65, 0.1);
      border-color: var(--cyber-accent);
      color: var(--cyber-primary);
    }
  }

  // 故障效果
  @keyframes glitch {
    0%, 100% { text-shadow: 2px 0 var(--cyber-primary), -2px 0 var(--cyber-accent); }
    25% { text-shadow: -2px 0 var(--cyber-primary), 2px 0 var(--cyber-accent); }
    50% { text-shadow: 2px 0 var(--cyber-accent), -2px 0 var(--cyber-primary); }
    75% { text-shadow: -2px 0 var(--cyber-accent), 2px 0 var(--cyber-primary); }
  }
}
